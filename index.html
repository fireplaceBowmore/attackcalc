<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>7x5 Interactive Table with Row Sums</title>
  <style>
    table, th, td { border: 1px solid #ccc; border-collapse: collapse; padding: 8px; }
    input[type="number"] { width: 60px; }
    th, td { text-align: center; }
    /* Remove number input spinners (all browsers) */
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    input[type=number] {
      -moz-appearance: textfield; /* Firefox */
      appearance: textfield; /* Standard */
    }
  </style>
</head>
<body>
  <table>
    <thead>
      <tr>
        <th>Col 1</th>
        <th>Col 2</th>
        <th>Col 3</th>
        <th>Col 4</th>
        <th>Col 5</th>
        <th>Col 6</th>
        <th>Col 7</th>
        <th>Sum</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input type="number" oninput="calcSum(0); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(0); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(0); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(0); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(0); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(0); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(0); saveTableData()" /></td>
        <td id="sum0">0</td>
      </tr>
      <tr>
        <td><input type="number" oninput="calcSum(1); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(1); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(1); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(1); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(1); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(1); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(1); saveTableData()" /></td>
        <td id="sum1">0</td>
      </tr>
      <tr>
        <td><input type="number" oninput="calcSum(2); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(2); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(2); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(2); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(2); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(2); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(2); saveTableData()" /></td>
        <td id="sum2">0</td>
      </tr>
      <tr>
        <td><input type="number" oninput="calcSum(3); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(3); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(3); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(3); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(3); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(3); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(3); saveTableData()" /></td>
        <td id="sum3">0</td>
      </tr>
      <tr>
        <td><input type="number" oninput="calcSum(4); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(4); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(4); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(4); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(4); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(4); saveTableData()" /></td>
        <td><input type="number" oninput="calcSum(4); saveTableData()" /></td>
        <td id="sum4">0</td>
      </tr>
    </tbody>
  </table>

  <script>
    // Add error handling for calcSum
    function calcSum(row) {
      try {
        const tr = document.querySelectorAll('tbody tr')[row];
        if (!tr) throw new Error('Row not found');
        
        let sum = 0;
        tr.querySelectorAll('input[type="number"]').forEach(input => {
          const value = Number(input.value);
          // Check for invalid numbers
          if (input.value && isNaN(value)) {
            throw new Error('Invalid number input');
          }
          sum += value || 0;
        });
        
        const sumElement = document.getElementById('sum' + row);
        if (!sumElement) throw new Error('Sum element not found');
        sumElement.innerText = sum;
      } catch (error) {
        console.error('Error in calcSum:', error);
      }
    }

    // Add error handling for saveTableData
    function saveTableData() {
      try {
        const rows = document.querySelectorAll('tbody tr');
        const data = [];
        rows.forEach(tr => {
          const row = [];
          tr.querySelectorAll('input[type="number"]').forEach(input => {
            row.push(input.value);
          });
          data.push(row);
        });
        localStorage.setItem('tableData', JSON.stringify(data));
      } catch (error) {
        console.error('Error saving table data:', error);
      }
    }

    // Add error handling for loadTableData
    function loadTableData() {
      try {
        const savedData = localStorage.getItem('tableData');
        if (!savedData) return;
        
        const data = JSON.parse(savedData);
        if (!Array.isArray(data)) throw new Error('Invalid saved data format');
        
        const rows = document.querySelectorAll('tbody tr');
        data.forEach((row, i) => {
          if (!Array.isArray(row)) throw new Error('Invalid row format');
          if (rows[i]) {
            const inputs = rows[i].querySelectorAll('input[type="number"]');
            row.forEach((value, j) => {
              if (inputs[j]) {
                inputs[j].value = value || '';
              }
            });
          }
        });
        
        // Recalculate sums after loading
        rows.forEach((_, i) => calcSum(i));
      } catch (error) {
        console.error('Error loading table data:', error);
        // Clear potentially corrupted data
        localStorage.removeItem('tableData');
      }
    }

    // Add DOMContentLoaded event listener for more reliable initialization
    document.addEventListener('DOMContentLoaded', loadTableData);
  </script>
</body>
</html>
